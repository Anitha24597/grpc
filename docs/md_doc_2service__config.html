<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GRPC Core: Service Config in gRPC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">GRPC Core<span id="projectnumber">&#160;46.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Service Config in gRPC</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md283"></a>
Objective</h1>
<p>The service config is a mechanism that allows service owners to publish parameters to be automatically used by all clients of their service.</p>
<h1><a class="anchor" id="autotoc_md284"></a>
Format</h1>
<p>The fields of the service config are defined by the <a href="https://github.com/grpc/grpc-proto/blob/master/grpc/service_config/service_config.proto"><code>grpc.service_config.ServiceConfig</code> protocol buffer message</a>. Note that new fields may be added in the future as new functionality is introduced.</p>
<p>Internally, gRPC uses the service config in JSON form. The JSON representation is the result of converting the protobuf form into JSON using the normal <a href="https://developers.google.com/protocol-buffers/docs/proto3#json">protobuf to JSON translation rules</a>. In particular, this means:</p><ul>
<li>Field names are converted from <code>snake_case</code> to <code>camelCase</code>.</li>
<li>Field values are converted as per the documented translation rules:<ul>
<li>Strings, 32-bit integers, and bools are converted into the corresponding JSON types.</li>
<li>64-bit integers are converted into strings (e.g., <code>"251"</code>).</li>
<li>The value of a repeated field will be represented as a JSON array.</li>
<li>The value of a <code>google.protobuf.Duration</code> will be represented as a string containing a decimal number of seconds (e.g., <code>"1.000340012s"</code>).</li>
</ul>
</li>
</ul>
<p>For more details, see the protobuf docs linked above.</p>
<p>Note that the JSON representation has one advantage over the protobuf representation, which is that it is possible to encode configurations for <a class="el" href="md_doc_2load-balancing.html">LB policies</a> that are not known to gRPC. In protobuf form, the <code>loadBalancingConfig</code> field contains a <code>oneof</code> supporting only the built-in LB policies. However, in JSON form, the field inside the <code>oneof</code> is encoded as a string that indicates the LB policy name. In JSON form, that string can be any arbitrary value, not just one of the supported policies inside of the <code>oneof</code>, so third-party policies can be selected.</p>
<h1><a class="anchor" id="autotoc_md285"></a>
Architecture</h1>
<p>A service config is associated with a server name. The <a class="el" href="md_doc_2naming.html">name</a>resolver" plugin, when asked to resolve a particular server
name, will return both the resolved addresses and the service config.

The name resolver returns the service config to the gRPC client in JSON form.
Individual resolver implementations determine where and in what format the
service config is stored.  If the resolver implementation obtains the
service config in protobuf form, it must convert it to JSON.
Alternatively, a resolver implementation may obtain the service config
already in JSON form, in which case it may return it directly.  Or it
may construct the JSON dynamically from some other source data.

For details of how the DNS resolver plugin supports service configs, see
&lt;a href="<a href="https://github.com/grpc/proposal/blob/master/A2-service-configs-in-dns.md">https://github.com/grpc/proposal/blob/master/A2-service-configs-in-dns.md</a>"
 &gt;gRFC A2: Service Config via DNS&lt;/a&gt;.

@section autotoc_md286 Example

Here is an example service config in protobuf form:

@icode{textproto} 
{
  # Use round_robin LB policy.
  load_balancing_config: { round_robin: {} }
  # This method config applies to method "foo/bar" and to all methods
  # of service "baz".
  method_config: {
    name: {
      service: "foo"
      method: "bar"
    }
    name: {
      service: "baz"
    }
    # Default timeout for matching methods.
    timeout: {
      seconds: 1
      nanos: 1
    }
  }
}
@endicode 

Here is the same example service config in JSON form:

@icode{json} 
{
  "loadBalancingConfig": [ { "round_robin": {} } ],
  "methodConfig": [
    {
      "name": [
        { "service": "foo", "method": "bar" },
        { "service": "baz" }
      ],
      "timeout": "1.000000001s" } ] } </p>
<h1><a class="anchor" id="autotoc_md287"></a>
APIs</h1>
<p>The service config is used in the following APIs:</p>
<ul>
<li>In the resolver API, used by resolver plugins to return the service config to the gRPC client.</li>
<li>In the gRPC client API, where users can query the channel to obtain the service config associated with the channel (for debugging purposes).</li>
<li>In the gRPC client API, where users can set the service config explicitly. This can be used to set the config in unit tests. It can also be used to set the default config that will be used if the resolver plugin does not return a service config. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 18 2025 17:12:15 for GRPC Core by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
